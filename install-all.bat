@echo off
echo ===============================================================================
echo                        XPANEL - УСТАНОВКА ВСЕХ ЗАВИСИМОСТЕЙ
echo ===============================================================================
echo.

cd /d "%~dp0"

echo [1/4] Проверка Node.js...
node --version >nul 2>&1
if errorlevel 1 (
    echo ОШИБКА: Node.js не установлен!
    echo Скачайте и установите Node.js с https://nodejs.org/
    pause
    exit /b 1
)

echo Node.js найден: 
node --version
echo.

echo [2/4] Установка зависимостей сервера...
call npm install
if errorlevel 1 (
    echo ОШИБКА: Не удалось установить зависимости сервера!
    pause
    exit /b 1
)
echo ✓ Зависимости сервера установлены
echo.

echo [3/4] Установка зависимостей клиента...
cd client
call npm install
if errorlevel 1 (
    echo ОШИБКА: Не удалось установить зависимости клиента!
    pause
    exit /b 1
)
echo ✓ Зависимости клиента установлены
echo.

cd ..

echo [4/4] Готово!
echo.
echo ===============================================================================
echo                            УСТАНОВКА ЗАВЕРШЕНА!
echo ===============================================================================
echo.
echo Для запуска Xpanel используйте:
echo   start.bat           - Запуск полного приложения (сервер + клиент)
echo   start-server.bat    - Запуск только сервера
echo   start-client.bat    - Запуск только клиента
echo.
echo Приложение будет доступно по адресу: http://localhost:3001
echo.

pause
